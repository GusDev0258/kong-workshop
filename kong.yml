_format_version: "3.0"
_transform: true

# services:
#   - name: auth-service
#     host: auth-ms
#     port: 3000
#     protocol: http

#   - name: product-service
#     host: product-upstream 
#     port: 3000
#     protocol: http

# routes:
#   - name: auth-route
#     service: auth-service
#     paths:
#       - /auth
#     strip_path: true

#   - name: product-route
#     service: product-service
#     paths:
#       - /products
#     strip_path: true

# upstreams:
#   - name: product-upstream
#     algorithm: round-robin
#     targets:
#       - target: 'product-ms-1:3000'
#         weight: 100
#       - target: 'product-ms-2:3000'
#         weight: 100

# plugins:
#   - name: jwt
#     route: product-route 
#     config:
#       cookie_names:
#         - access_token
  
#   - name: request-transformer
#     route: product-route 
#     config:
#       add:
#         headers:
#           - "X-Customer-State:$(jwt_claim_state)"